const editForm=document.getElementById("form"),registerForm=document.getElementById("registerForm");if(editForm){const a=editForm.querySelectorAll("input"),b=editForm.querySelectorAll("select");for(i=0;i<a.length;i++)a[i].addEventListener("change",()=>{updateProfile(editForm)});for(i=0;i<b.length;i++)b[i].addEventListener("change",()=>{updateProfile(editForm)})}const login=e=>{event.preventDefault();e={username:e.elements.username.value,password:e.elements.password.value};sendData("/login",e)},registerUser=e=>{event.preventDefault();let t,r;marker&&(t=marker._latlng.lat,r=marker._latlng.lng);e={username:e.elements.username.value,password:e.elements.password.value,email:e.elements.email.value,name:e.elements.name.value,gender:e.elements.gender.value,age:e.elements.age.value,looking:e.elements.looking.value,lat:t,lng:r};sendData("/register",e)},updateProfile=e=>{e={name:e.elements.name.value,age:e.elements.age.value,gender:e.elements.gender.value,looking:e.elements.looking.value,lat:e.elements.lat.value,lng:e.elements.lng.value};sendData("/edit",e)},updateValues=e=>{let t=document.getElementById("lat"),r=document.getElementById("lng");var n=document.getElementById("form");t.setAttribute("value",e._latlng.lat),r.setAttribute("value",e._latlng.lng),updateProfile(n)},sendData=async(e,t)=>{xhr=new XMLHttpRequest;const r=document.querySelector(".error-display");let n=[];for(property in t){var l=encodeURIComponent(property),a=encodeURIComponent(t[property]);n.push(l+"="+a)}n=n.join("&"),editForm?editForm.parentNode.classList.remove("updated"):registerForm&&registerForm.parentNode.classList.remove("error");try{xhr.open("POST",e),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onload=function(){200==this.status?"logged in"===this.responseText?window.location.replace("/"):"updated profile"===this.responseText?editForm.parentNode.classList.add("updated"):(registerForm&&registerForm.parentNode.classList.add("error"),r.innerHTML=this.responseText):r.innerHTML=this.responseText},xhr.send(n)}catch(e){console.log(e)}};